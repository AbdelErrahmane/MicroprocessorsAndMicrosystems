#pragma once
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { 0.0f };
                        float theta[30] = { 0 };
                        float sigma[30] = { 0 };
                        theta[0] = 1.213226246077; theta[1] = 2.152750476462; theta[2] = -1.192992037488; theta[3] = -1.444882306515; theta[4] = 6.301169622215; theta[5] = -2.445701596978; theta[6] = 1.063025708674; theta[7] = -0.265961816276; theta[8] = 4.178653667034; theta[9] = 4.772932296201; theta[10] = 0.776006013195; theta[11] = 0.417603503721; theta[12] = 0.290048197237; theta[13] = 6.462256685124; theta[14] = -0.03996573478; theta[15] = 0.990824348334; theta[16] = 0.009175651666; theta[17] = 0.95463285224; theta[18] = 0.04536714776; theta[19] = 0.314625063889; theta[20] = 0.639326307591; theta[21] = 0.04604862852; theta[22] = 4.8677197e-05; theta[23] = 0.891766252099; theta[24] = 0.108160732105; theta[25] = 2.4338599e-05; theta[26] = 0.990824348334; theta[27] = 0.009175651666; theta[28] = 0.968092097257; theta[29] = 0.031907902743;
                        sigma[0] = 273.263979678582; sigma[1] = 1.241882169826; sigma[2] = 3.641402647563; sigma[3] = 1.08717394975; sigma[4] = 69.349480527768; sigma[5] = 4.351485587082; sigma[6] = 14.688159883117; sigma[7] = 2.10396174406; sigma[8] = 220.972732845716; sigma[9] = 220.509458807425; sigma[10] = 235.115317339384; sigma[11] = 79.446813760234; sigma[12] = 222.918309042071; sigma[13] = 39.625986868497; sigma[14] = 0.554328751884; sigma[15] = 0.009092459082; sigma[16] = 0.009092459082; sigma[17] = 0.043309969664; sigma[18] = 0.043309969664; sigma[19] = 0.215637133062; sigma[20] = 0.230589180013; sigma[21] = 0.043929152331; sigma[22] = 4.9674828e-05; sigma[23] = 0.096520203716; sigma[24] = 0.096462988136; sigma[25] = 2.5338006e-05; sigma[26] = 0.009092459082; sigma[27] = 0.009092459082; sigma[28] = 0.030890788486; sigma[29] = 0.030890788486;
                        votes[0] = 0.003626694206 - gauss(x, theta, sigma);
                        theta[0] = -0.003388555628; theta[1] = -0.484653451695; theta[2] = 0.203858929043; theta[3] = -0.240708775824; theta[4] = -0.06076091186; theta[5] = 0.224154644487; theta[6] = -0.645771755312; theta[7] = -0.838207028275; theta[8] = -0.014476051626; theta[9] = -0.016474026508; theta[10] = -0.140536562679; theta[11] = -0.0177823583; theta[12] = -0.372560375929; theta[13] = -0.197382677269; theta[14] = -0.1846249069; theta[15] = 0.998573760835; theta[16] = 0.001426239165; theta[17] = 1.0; theta[18] = 0.0; theta[19] = 5.3813485e-05; theta[20] = 0.005636053581; theta[21] = 0.994310132934; theta[22] = 0.0; theta[23] = 0.005640235034; theta[24] = 0.994359764966; theta[25] = 0.0; theta[26] = 0.998573760835; theta[27] = 0.001426239165; theta[28] = 1.0; theta[29] = 0.0;
                        sigma[0] = 5.8611386e-05; sigma[1] = 0.019941301637; sigma[2] = 0.2644874373; sigma[3] = 0.380682028983; sigma[4] = 0.065151907529; sigma[5] = 0.249119584261; sigma[6] = 0.009846847719; sigma[7] = 0.015692764639; sigma[8] = 0.110487068218; sigma[9] = 0.147561097473; sigma[10] = 0.001436326943; sigma[11] = 1.7197337e-05; sigma[12] = 0.00371866489; sigma[13] = 0.03368863467; sigma[14] = 0.001219051423; sigma[15] = 0.001425205007; sigma[16] = 0.001425205007; sigma[17] = 1e-06; sigma[18] = 1e-06; sigma[19] = 5.4810589e-05; sigma[20] = 0.00560528848; sigma[21] = 0.005658492479; sigma[22] = 1e-06; sigma[23] = 0.005609422783; sigma[24] = 0.005609422783; sigma[25] = 1e-06; sigma[26] = 0.001425205007; sigma[27] = 0.001425205007; sigma[28] = 1e-06; sigma[29] = 1e-06;
                        votes[1] = 0.485519968576 - gauss(x, theta, sigma);
                        theta[0] = -0.005302087069; theta[1] = 0.119084847791; theta[2] = 0.099354021731; theta[3] = 0.476927551842; theta[4] = -0.002312820279; theta[5] = 0.05279946995; theta[6] = 0.660007562744; theta[7] = 1.006707946325; theta[8] = -0.016039630339; theta[9] = -0.018234715175; theta[10] = 0.147043911476; theta[11] = -0.007599384257; theta[12] = 0.430305390364; theta[13] = 0.029348888889; theta[14] = -0.105930622714; theta[15] = 0.714826103015; theta[16] = 0.285173896985; theta[17] = 1.0; theta[18] = 0.0; theta[19] = 0.000105786607; theta[20] = 0.993539617884; theta[21] = 0.006354595508; theta[22] = 0.0; theta[23] = 0.993743392087; theta[24] = 0.006256607913; theta[25] = 0.0; theta[26] = 0.714826103015; theta[27] = 0.285173896985; theta[28] = 1.0; theta[29] = 0.0;
                        sigma[0] = 3.1665156e-05; sigma[1] = 0.828566137757; sigma[2] = 0.650690157566; sigma[3] = 1.07685997323; sigma[4] = 0.912456243222; sigma[5] = 0.827044735315; sigma[6] = 0.089198879448; sigma[7] = 0.376021987498; sigma[8] = 0.06165192229; sigma[9] = 0.087904473357; sigma[10] = 0.012209048764; sigma[11] = 0.001278063289; sigma[12] = 0.040875553139; sigma[13] = 0.088722161095; sigma[14] = 0.433815429289; sigma[15] = 0.203850745448; sigma[16] = 0.203850745448; sigma[17] = 1e-06; sigma[18] = 1e-06; sigma[19] = 0.000106775417; sigma[20] = 0.006419645579; sigma[21] = 0.006315214624; sigma[22] = 1e-06; sigma[23] = 0.006218462771; sigma[24] = 0.006218462771; sigma[25] = 1e-06; sigma[26] = 0.203850745448; sigma[27] = 0.203850745448; sigma[28] = 1e-06; sigma[29] = 1e-06;
                        votes[2] = 0.441399146442 - gauss(x, theta, sigma);
                        theta[0] = -0.006800097282; theta[1] = 2.519446226064; theta[2] = -1.993957604212; theta[3] = -1.272880889179; theta[4] = 0.110558337551; theta[5] = -1.775262380064; theta[6] = 0.256102941848; theta[7] = -0.524568550838; theta[8] = -0.016292083322; theta[9] = -0.018535313741; theta[10] = 0.004935792739; theta[11] = 0.14392309317; theta[12] = -0.146298740411; theta[13] = 0.849189803102; theta[14] = 1.967174130837; theta[15] = 0.944421618225; theta[16] = 0.055578381775; theta[17] = 0.999801560296; theta[18] = 0.000198439704; theta[19] = 0.586961748203; theta[20] = 0.39631207442; theta[21] = 0.016726177377; theta[22] = 0.000679274372; theta[23] = 0.998679612737; theta[24] = 0.000641112891; theta[25] = 0.0; theta[26] = 0.944441971015; theta[27] = 0.055558028985; theta[28] = 1.0; theta[29] = 0.0;
                        sigma[0] = 0.02989482611; sigma[1] = 0.60728804527; sigma[2] = 3.819378758631; sigma[3] = 1.256906456898; sigma[4] = 2.413283804165; sigma[5] = 3.340576461188; sigma[6] = 3.604866810774; sigma[7] = 0.157631255016; sigma[8] = 0.049939261233; sigma[9] = 0.044290674159; sigma[10] = 0.638995472767; sigma[11] = 4.674030851747; sigma[12] = 0.232182248429; sigma[13] = 8.263856338819; sigma[14] = 7.431023285099; sigma[15] = 0.052490425255; sigma[16] = 0.052490425255; sigma[17] = 0.000199400326; sigma[18] = 0.000199400326; sigma[19] = 0.24243865435; sigma[20] = 0.239249814088; sigma[21] = 0.016447412368; sigma[22] = 0.000679812958; sigma[23] = 0.00131964384; sigma[24] = 0.000641701865; sigma[25] = 1e-06; sigma[26] = 0.0524723344; sigma[27] = 0.0524723344; sigma[28] = 1e-06; sigma[29] = 1e-06;
                        votes[3] = 0.06939090215 - gauss(x, theta, sigma);
                        theta[0] = 0.907152199039; theta[1] = 1.753304682555; theta[2] = -2.263074819392; theta[3] = -1.264010777744; theta[4] = -0.04179626747; theta[5] = -1.269216901139; theta[6] = 9.193185958462; theta[7] = -0.457128660378; theta[8] = 1.329063256116; theta[9] = 0.370884656855; theta[10] = 2.708462228446; theta[11] = 7.68824226852; theta[12] = 0.773527392656; theta[13] = 8.152828949501; theta[14] = 0.596020587926; theta[15] = 0.662482566248; theta[16] = 0.337517433752; theta[17] = 1.0; theta[18] = 0.0; theta[19] = 0.827057182706; theta[20] = 0.0; theta[21] = 0.172942817294; theta[22] = 0.34170153417; theta[23] = 0.65829846583; theta[24] = 0.0; theta[25] = 0.0; theta[26] = 0.672245467225; theta[27] = 0.327754532775; theta[28] = 1.0; theta[29] = 0.0;
                        sigma[0] = 22.559738564607; sigma[1] = 2.772436815938; sigma[2] = 3.590494726861; sigma[3] = 0.838463843326; sigma[4] = 0.026285232604; sigma[5] = 4.655901881166; sigma[6] = 3850.377873318954; sigma[7] = 0.166143640983; sigma[8] = 799.616083055608; sigma[9] = 60.54894303192; sigma[10] = 1186.62189036947; sigma[11] = 6019.631864950828; sigma[12] = 73.245268564979; sigma[13] = 36.960609775928; sigma[14] = 3.310378737806; sigma[15] = 0.223600415665; sigma[16] = 0.223600415665; sigma[17] = 1e-06; sigma[18] = 1e-06; sigma[19] = 0.143034599241; sigma[20] = 1e-06; sigma[21] = 0.143034599241; sigma[22] = 0.224942595716; sigma[23] = 0.224942595716; sigma[24] = 1e-06; sigma[25] = 1e-06; sigma[26] = 0.220332499021; sigma[27] = 0.220332499021; sigma[28] = 1e-06; sigma[29] = 1e-06;
                        votes[4] = 6.3288625e-05 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 30; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }
